<!-- ðŸŸ¢ index.html -->
<!-- ðŸŸ¢ index.html â€” start of file -->
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta
    name="viewport"
    content="width=device-width, initial-scale=1, viewport-fit=cover"
  />
  <title>The Oklahoma Observer</title>
  <link rel="icon" href="favicon.ico" />
  <meta name="theme-color" content="#1E90FF" />

  <!-- Performance: preconnect to API proxy -->
  <link rel="preconnect" href="https://okobserver-proxy.bob-b5c.workers.dev" />
  <link rel="dns-prefetch" href="https://okobserver-proxy.bob-b5c.workers.dev" />

  <!-- CSS -->
  <link
    rel="preload"
    href="override.css?v=2025-12-03-R3"
    as="style"
  />
  <link
    rel="stylesheet"
    href="override.css?v=2025-12-03-R3"
  />

  <!-- Main SPA entry -->
  <script
    defer
    src="main.js?v=2025-12-03-R10"
  ></script>
  <script
    defer
    src="PostDetail.js?v=2025-11-19R7-noopVideoHelper"
  ></script>
</head>
<body>
  <header class="oo-header" role="banner" aria-label="Site header">
    <div class="oo-header-inner">
      <!-- Left spacer so the center column can truly center the brand -->
      <div aria-hidden="true"></div>

      <a class="oo-brand" href="#/">
        <img class="oo-logo" src="logo.png" alt="The Oklahoma Observer" />
        <div class="oo-motto">
          To Comfort The Afflicted And Afflict The Comfortable
        </div>
      </a>

      <button
        class="oo-hamburger"
        data-oo="hamburger"
        aria-label="Menu"
        aria-expanded="false"
        aria-controls="oo-menu"
      >
        â‰¡
      </button>
    </div>
  </header>

  <!-- Overlay + Menu (hamburger) -->
  <div class="oo-overlay" data-oo="overlay" hidden></div>
  <nav 
    class="oo-menu"
    id="oo-menu"
    data-oo="menu"
    aria-label="Main navigation"
  >
    <ul class="oo-menu-list">
      <li><a href="#/">Posts</a></li>
      <li><a href="#/about">About</a></li>
      <li><a href="#/search">Search</a></li>
    </ul>
  </nav>

  <!-- App root -->
  <main id="app" role="main"></main>

  <!-- Splash / hero video container (can be hidden via CSS on home if desired) -->
  <div class="oo-splash" aria-hidden="true">
    <video
      class="oo-splash-video"
      autoplay
      muted
      loop
      playsinline
    >
      <!-- New splash video file -->
      <source
        src="Animated_Logo_Into_Cell_Phone.mp4?v=2025-11-28R2-splash1"
        type="video/mp4"
      />
      <!-- Fallback -->
      Your browser does not support the video tag.
    </video>
  </div>

  <!-- MutationObserver grid enforcer (must remain) -->
  
  <script>
    // ðŸŸ¢ index.html â€” inline header script start
    (function () {
      function initHeader() {
        var hamburger = document.querySelector('[data-oo="hamburger"]');
        var overlay = document.querySelector('[data-oo="overlay"]');
        var menu = document.querySelector('[data-oo="menu"]');

        if (!hamburger || !overlay || !menu) {
          console.warn('[OkObserver] Header script: elements not found');
          return;
        }

        function setOpen(isOpen) {
          document.body.classList.toggle('is-menu-open', isOpen);
          hamburger.setAttribute('aria-expanded', isOpen ? 'true' : 'false');
          overlay.hidden = !isOpen;
        }

        hamburger.addEventListener('click', function (evt) {
          evt.preventDefault();
          var isOpen = !document.body.classList.contains('is-menu-open');
          setOpen(isOpen);
        });

        overlay.addEventListener('click', function () {
          setOpen(false);
        });

        menu.addEventListener('click', function (evt) {
          var target = evt.target;
          if (target && target.tagName === 'A') {
            setOpen(false);
          }
        });

        window.addEventListener('hashchange', function () {
          setOpen(false);
        });

        console.log('[OkObserver] Header script initialized.');
      }

      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', initHeader);
      } else {
        initHeader();
      }
    })();
    // ðŸ”´ index.html â€” inline header script end
  </script>

  <script>
    // ðŸŸ¢ index.html â€” grid-enforcer start of file
    (function () {
      function enforceGrid() {
        const grid = document.querySelector('#app .posts-grid');
        if (!grid) return;
        grid.querySelectorAll('.post-card').forEach(function (card) {
          card.classList.add('post-card');
        });
      }

      const app = document.getElementById('app');
      if (app) {
        const mo = new MutationObserver(enforceGrid);
        mo.observe(app, { childList: true, subtree: true });
      }

      window.addEventListener('hashchange', enforceGrid);
      document.addEventListener('okobs:route', enforceGrid);
      setInterval(enforceGrid, 1500);
    })();
    // ðŸ”´ index.html â€” grid-enforcer end of file
  </script>

  <!-- Service worker registration (must stay in index.html, not main.js) -->
  <script>
    (function () {
      if (!('serviceWorker' in navigator)) {
        console.log('[OkObserver] SW not supported in this browser.');
        return;
      }

      var SW_BUILD = '2025-11-25-ITS29-1'; // bump when sw.js changes
      var SW_URL = '/okobserver/sw.js';
      var SCOPE = '/okobserver/';

      window.addEventListener('load', function () {
        navigator.serviceWorker
          .getRegistration(SCOPE)
          .then(function (reg) {
            if (!reg) return;
            if (!reg.active) return;
            if (!reg.active.scriptURL) return;
            if (reg.active.scriptURL.indexOf(SW_BUILD) === -1) {
              console.log('[OkObserver] SW build mismatch, unregisteringâ€¦');
              return reg.unregister();
            }
          })
          .catch(function (err) {
            console.warn('[OkObserver] SW getRegistration error:', err);
          })
          .then(function () {
            return navigator.serviceWorker.register(SW_URL + '?v=' + SW_BUILD, {
              scope: SCOPE,
              updateViaCache: 'none'
            });
          })
          .then(function (reg) {
            if (reg) console.log('[OkObserver] SW registered:', reg.scope);
          })
          .catch(function (err) {
            console.warn('[OkObserver] SW register error:', err);
          });
      });
    })();
  </script>
</body>
</html>
<!-- ðŸ”´ index.html â€” end of file -->
<!-- ðŸ”´ index.html -->
