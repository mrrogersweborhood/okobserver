<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
    />
    <meta
      name="description"
      content="The Oklahoma Observer — To comfort the afflicted and afflict the comfortable."
    />
    <meta name="theme-color" content="#1E90FF" />
    <meta name="mobile-web-app-capable" content="yes" />
    <link rel="manifest" href="./manifest.json?v=2025-10-31a" />

    <title>The Oklahoma Observer</title>

    <!-- Favicon and icons -->
    <link rel="icon" type="image/png" href="icon-192.png" />
    <link rel="apple-touch-icon" href="icon-512.png" />

    <!-- Styles -->
    <link rel="stylesheet" href="override.css?v=2025-10-31d" />

    <!-- Inline fallback styles -->
    <style>
      body {
        margin: 0;
        background: #ffffff;
        font-family: system-ui, -apple-system, "Segoe UI", Roboto, Ubuntu, sans-serif;
      }
      .loading {
        text-align: center;
        padding: 3rem;
        color: #555;
      }
    </style>
  </head>

  <body>
    <!-- HEADER -->
    <header>
      <div class="header-inner">
        <div class="logo">
          <img src="logo.png" alt="The Oklahoma Observer logo" />
          <div class="motto">
            To comfort the afflicted and afflict the comfortable
          </div>
        </div>

        <button class="hamburger" id="hamburger" aria-label="Menu">☰</button>
      </div>

      <nav class="nav-menu" id="navMenu">
        <a href="#/">Posts</a>
        <a href="#/about">About</a>
        <a href="#/settings">Settings</a>
      </nav>
    </header>

    <!-- MAIN APP CONTAINER -->
    <main id="app">
      <div class="loading">Loading…</div>
    </main>

    <!-- FOOTER -->
    <footer>
      © <span id="year"></span> The Oklahoma Observer
      <br />
      Build <span id="build"></span>
    </footer>

    <!-- MutationObserver grid enforcer -->
    <script>
      function enforceGrid() {
        const grid = document.querySelector(".grid");
        if (grid && !grid.classList.contains("enforceGrid")) {
          grid.classList.add("enforceGrid");
        }
      }
      const observer = new MutationObserver(enforceGrid);
      observer.observe(document.body, { childList: true, subtree: true });
    </script>

    <!-- Main app logic -->
    <script src="main.js?v=2025-10-31c"></script>

    <!-- Service worker registration -->
    <script>
      if ("serviceWorker" in navigator) {
        window.addEventListener("load", () => {
          navigator.serviceWorker
            .register("./sw.js?v=2025-10-31c")
            .then(() =>
              console.log("[OkObserver] Service Worker registered successfully")
            )
            .catch((err) =>
              console.warn("[OkObserver] SW registration failed:", err)
            );
        });
      }
      document.getElementById("year").textContent = new Date().getFullYear();
      document.getElementById("build").textContent = "2025-10-31e";
    </script>
  </body>
</html>
