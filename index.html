<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta
    name="viewport"
    content="width=device-width, initial-scale=1, viewport-fit=cover"
  />
  <title>OkObserver</title>
  <meta name="theme-color" content="#1E90FF" />

  <!-- Preconnects / DNS hints (safe) -->
  <link rel="preconnect" href="https://okobserver-proxy.bob-b5c.workers.dev" crossorigin>
  <link rel="dns-prefetch" href="//okobserver-proxy.bob-b5c.workers.dev">

  <!-- Favicon (keep your preferred filename) -->
  <link rel="icon" href="favicon.ico" sizes="any">

  <!-- Styles -->
  <link rel="stylesheet" href="override.css?v=2025-11-06SR1-gridLock1" />

  <style>
    /* Minimal critical CSS guard: ensure grid retains columns before CSS loads fully */
    .oo-grid{display:grid;gap:16px}
  </style>
</head>
<body>
  <header id="oo-header" class="oo-header">
    <div class="oo-brand">
      <img src="favicon.ico" alt="" class="oo-logo" decoding="async" />
      <div class="oo-title">
        <h1 class="oo-name">The Oklahoma Observer</h1>
        <p class="oo-motto">To comfort the afflicted and afflict the comfortable</p>
      </div>
      <button id="oo-menu" class="oo-menu" aria-label="Menu" aria-expanded="false">☰</button>
    </div>
    <nav id="oo-nav" class="oo-nav" hidden>
      <a href="#/">Posts</a>
      <a href="#/about">About</a>
    </nav>
  </header>

  <main id="app" class="oo-app" inert>
    <!-- App content mounts here -->
  </main>

  <footer class="oo-footer">
    © 2025 The Oklahoma Observer • <span id="oo-build">Build 2025-11-06SR1-perfSWR1-hotfix3</span>
  </footer>

  <!-- App core (no ES modules) -->
  <script>
    // Version banner surfaced early for SW + cache bust
    window.__OKO__ = window.__OKO__ || {};
    window.__OKO__.VER = "2025-11-06SR1-perfSWR1-hotfix3";
    window.__OKO__.DEBUG = false; // flip to true to enable observability logs/counters
  </script>
  <script defer src="main.js?v=2025-11-06SR1-perfSWR1-hotfix3"></script>
  <script>
    // Defer non-critical enabling using requestIdleCallback (safe)
    (window.requestIdleCallback || function(cb){return setTimeout(cb,50)})(function(){
      document.getElementById('app')?.removeAttribute('inert');
    });
  </script>

  <!-- SW registration stays identical; file hardened in sw.js -->
  <script>
    (function(){
      if ('serviceWorker' in navigator) {
        navigator.serviceWorker.register('sw.js?v=2025-11-06SR1-perfSWR1-hotfix3')
          .catch(console.warn);
      }
    })();
  </script>
</body>
</html>
